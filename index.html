<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ma Boutique</title>
  <style>
    body { font-family: Arial; background:#f2f2f2; padding:20px; }
    .product { background:white; padding:15px; margin:15px 0; border-radius:8px; }
    img { width:150px; border-radius:8px; }
    input, button { padding:8px; margin:5px 0; }
  </style>
</head>
<body>

<h1>üõç Nos Produits</h1>

<input type="text" id="search" placeholder="üîç Rechercher un produit..." onkeyup="searchProducts()">

<div id="products"></div>

<hr>

<h2>üõí Passer une commande</h2>
<form id="orderForm">
  <input type="text" id="clientName" placeholder="Votre nom" required><br>
  <input type="tel" id="phone" placeholder="T√©l√©phone" required><br>
  <input type="text" id="city" placeholder="Ville" required><br>

  <input type="hidden" id="productName">
  <input type="hidden" id="price">
  <input type="hidden" id="sellerName">

  <button type="submit">Commander</button>
</form>

<h3>üí≥ Paiement apr√®s commande :</h3>
<p>Orange Money : +224 625 21 61 10</p>
<p>Mobile Money : +224 660 45 23 33</p>

<script>
const products = [
  {
    name: "Chaussures Nike",
    price: "450000",
    seller: "Boutique Alpha",
    image: "https://via.placeholder.com/150"
  },
  {
    name: "Sac √† main Dame",
    price: "300000",
    seller: "Fashion Store",
    image: "https://via.placeholder.com/150"
  },
  {
    name: "T√©l√©phone Samsung",
    price: "1200000",
    seller: "Tech Guin√©e",
    image: "https://via.placeholder.com/150"
  }
];

const container = document.getElementById("products");

function displayProducts(list) {
  container.innerHTML = "";
  list.forEach(p => {
    container.innerHTML += `
      <div class="product">
        <img src="${p.image}"><br>
        <strong>${p.name}</strong><br>
        üí∞ ${p.price} GNF<br>
        üè™ ${p.seller}<br>
        <button onclick="selectProduct('${p.name}', '${p.price}', '${p.seller}')">Commander</button>
      </div>
    `;
  });
}

displayProducts(products);

function searchProducts() {
  const term = document.getElementById("search").value.toLowerCase();
  const filtered = products.filter(p => p.name.toLowerCase().includes(term));
  displayProducts(filtered);
}

function selectProduct(name, price, seller) {
  document.getElementById("productName").value = name;
  document.getElementById("price").value = price;
  document.getElementById("sellerName").value = seller;
  window.scrollTo(0, document.body.scrollHeight);
}
</script>

<script type="module">
import { db } from './firebase.js';
import { collection, addDoc, Timestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

document.getElementById("orderForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const order = {
        clientName: document.getElementById("clientName").value,
        phone: document.getElementById("phone").value,
        city: document.getElementById("city").value,
        productName: document.getElementById("productName").value,
        price: document.getElementById("price").value,
        sellerName: document.getElementById("sellerName").value,
        date: Timestamp.now(),
        status: "En attente"
    };

    await addDoc(collection(db, "orders"), order);

    alert("Commande envoy√©e avec succ√®s !");
});
</script>

</body>
</html>
