<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Site E-commerce</title>
<style>
body {font-family: Arial; padding:20px; background:#00aa00; color:#fff; font-size:18px;}
h2,h3,h4{font-size:22px;margin-bottom:10px}

nav {position:fixed;top:20px;left:20px;z-index:1000;width:250px;}
nav button {font-size:22px;padding:12px 18px;margin-bottom:10px;}
#menu-list {display:none;background:#008000;padding:20px;font-size:22px;border-radius:12px;}
#menu-list li{margin:15px 0;cursor:pointer;list-style:none;}
#close-menu{background:#004400;color:#fff;padding:8px 12px;border:none;cursor:pointer;margin-bottom:10px;}

section{margin-top:200px; display:none;}
.produit{background:#66ff66;padding:10px;margin:10px;width:200px;display:inline-block;text-align:center;border-radius:8px}
.produit img{width:160px;height:160px;object-fit:cover;border-radius:6px}
button{padding:8px 12px;font-size:16px;background:#004400;color:white;border:none;margin:4px 0;cursor:pointer}
button:hover{opacity:0.9}
input,select,textarea{width:100%;padding:8px;margin-bottom:10px;font-size:16px;border-radius:6px}
.paiement-box{background:#006600;padding:10px;border-radius:8px;margin:10px 0}
#compteurPanier{background:red;color:#fff;padding:2px 6px;border-radius:50%;font-weight:bold;margin-left:5px}
#recherche{width:100%;padding:8px;margin-bottom:10px;font-size:16px;border-radius:6px}
</style>
</head>
<body>

<nav>
<button onclick="toggleMenu()">â˜° Menu</button>
<ul id="menu-list">
<button id="close-menu" onclick="toggleMenu()">Fermer</button>
<li onclick="showSection('produits-section')">Accueil</li>
<li onclick="showSection('vendeur-section')">Vendeur</li>
<li onclick="showSection('panier-section')">Panier <span id="compteurPanier">0</span></li>
<li onclick="showSection('admin-section')">Admin</li>
</ul>
<input type="text" id="recherche" placeholder="Rechercher un produit..." onkeyup="filtrerProduits()">
</nav>

<section id="produits-section" style="display:block">
<h2>Produits</h2>
<div id="produits-container"></div>
</section>

<section id="panier-section">
<h2>Panier</h2>
<div id="panier-container"></div>
<h3>Informations Client</h3>
<form id="commandeFormPanier">
<input type="text" id="clientNom" placeholder="Nom client" required>
<input type="text" id="clientTel" placeholder="TÃ©lÃ©phone client" required>
<h3>Informations Receveur</h3>
<input type="text" id="receveurNom" placeholder="Nom receveur" required>
<input type="text" id="receveurTel" placeholder="TÃ©lÃ©phone receveur" required>
<select id="villeLivraison" required></select>
<div class="paiement-box">
<h4>Moyens de paiement</h4>
<p>ðŸŸ  Orange Money : <b>+224625216110</b></p>
<p>ðŸ”µ Mobile Money : <b>+224660452333</b></p>
<p>AprÃ¨s paiement, envoyez la capture sur WhatsApp au 625216110</p>
</div>
<button type="submit">Valider la commande</button>
</form>
</section>

<section id="admin-section">
<h2>Commandes reÃ§ues (Admin)</h2>
<div id="admin-commandes"></div>
</section>

<section id="vendeur-section">
<h3>Inscription Vendeur</h3>
<form id="vendeurForm">
<input type="text" id="vendeur-username" placeholder="Nom utilisateur" required>
<input type="text" id="vendeur-phone" placeholder="TÃ©lÃ©phone" required>
<select id="vendeur-ville" required></select>
<button type="submit">Valider</button>
</form>
<div id="ajoutProduit" style="display:none">
<h3>Ajouter Produit</h3>
<form id="formProduit">
<input type="text" id="nomProduit" placeholder="Nom produit" required>
<textarea id="descProduit" placeholder="Description" required></textarea>
<input type="number" id="prixProduit" placeholder="Prix" required>
<input type="file" id="imageProduit" required>
<input type="number" id="stockProduit" placeholder="Stock" required>
<button type="submit">Ajouter</button>
</form>
</div>
</section>

<script>
const ADMIN_USER="papasta";
const ADMIN_PASS="papasta3494";
const villes=["Conakry - Kaloum","Conakry - Dixinn","Conakry - Ratoma","Conakry - Matam","Conakry - Matoto",
"BokÃ©","Kindia","LabÃ©","Mamou","Kankan","Faranah","NzÃ©rÃ©korÃ©","Coyah","Fria","Boffa","DubrÃ©ka",
"Yomou","Macenta","GuÃ©ckÃ©dou","NzÃ©rÃ©korÃ© Prefecture","Kouroussa","Siguiri","Kissidougou","KerouanÃ©",
"Mandiana","Dabola","LÃ©louma","TouguÃ©","Pita","Dalaba","Beyla","Koubia","Koundara","BokÃ© Prefecture"];

function remplirVilles(){
document.getElementById("vendeur-ville").innerHTML=villes.map(v=>`<option>${v}</option>`).join("");
document.getElementById("villeLivraison").innerHTML=villes.map(v=>`<option>${v}</option>`).join("");
}
remplirVilles();

function toggleMenu(){
const m=document.getElementById("menu-list");
m.style.display=m.style.display==="block"?"none":"block";
}

function showSection(id){
if(id==="admin-section"){
const pass=prompt("Mot de passe admin ?");
if(pass!==ADMIN_PASS){alert("AccÃ¨s refusÃ©"); return;}
afficherCommandes();
}
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
}

let produits=JSON.parse(localStorage.getItem("produits"))||[];
let panier=JSON.parse(localStorage.getItem("panier"))||[];
let commandes=JSON.parse(localStorage.getItem("commandes"))||[];
let vendeurConnecte=null;

function afficherProduits(liste=produits){
const container=document.getElementById("produits-container");
container.innerHTML="";
liste.forEach((p,i)=>{
container.innerHTML+=`<div class="produit">
<img src="${p.image}">
<h4>${p.nom}</h4>
<p>${p.prix} FG</p>
<p>Stock: ${p.stock}</p>
<p>QuantitÃ©: 
<select onchange="changerQuantite(${i},this.value)">
<option value="1">1</option>
<option value="10">10 (-2%)</option>
<option value="20">20 (-4%)</option>
<option value="50">50 (-5%)</option>
</select></p>
<button onclick="ajouterPanier(${i})">Ajouter au panier</button>
<button onclick="commanderDirect(${i})">Commander maintenant</button>
</div>`;
});
}

function filtrerProduits(){
const texte=document.getElementById("recherche").value.toLowerCase();
const filtre=produits.filter(p=>p.nom.toLowerCase().includes(texte));
afficherProduits(filtre);
}

function changerQuantite(index,val){
produits[index].quantite=Number(val);
}

function ajouterPanier(i){
let q=produits[i].quantite||1;
let prix=produits[i].prix;
if(q===10) prix*=0.98;
else if(q===20) prix*=0.96;
else if(q===50) prix*=0.95;
panier.push({...produits[i],prix:Math.round(prix),quantite:q});
localStorage.setItem("panier",JSON.stringify(panier));
afficherPanier();
vibration();
}

function commanderDirect(i){
panier=[produits[i]];
localStorage.setItem("panier",JSON.stringify(panier));
afficherPanier();
showSection("panier-section");
}

function afficherPanier(){
const c=document.getElementById("panier-container");
if(panier.length===0){c.innerHTML="<p>Panier vide</p>";}
else{
c.innerHTML="";
panier.forEach((p,i)=>{
c.innerHTML+=`<p>${p.nom} - ${p.prix} FG (x${p.quantite}) 
<button onclick="supprimerProduit(${i})">Supprimer</button></p>`;
});
}
document.getElementById("compteurPanier").innerText=panier.length;
}

function supprimerProduit(i){
panier.splice(i,1);
localStorage.setItem("panier",JSON.stringify(panier));
afficherPanier();
}

function vibration(){
if(navigator.vibrate) navigator.vibrate(50);
}

/* VENDEUR */
vendeurForm.onsubmit=e=>{
e.preventDefault();
vendeurConnecte={
username:vendeurForm["vendeur-username"].value,
phone:vendeurForm["vendeur-phone"].value,
ville:vendeurForm["vendeur-ville"].value
};
document.getElementById("ajoutProduit").style.display="block";
alert("Vendeur enregistrÃ©");
};

formProduit.onsubmit=e=>{
e.preventDefault();
const reader=new FileReader();
reader.onload=evt=>{
produits.push({
nom:nomProduit.value,
description:descProduit.value,
prix:prixProduit.value,
image:evt.target.result,
stock:stockProduit.value,
vendeur:vendeurConnecte.username
});
localStorage.setItem("produits",JSON.stringify(produits));
afficherProduits();
};
reader.readAsDataURL(imageProduit.files[0]);
};

/* COMMANDE */
commandeFormPanier.onsubmit=e=>{
e.preventDefault();
const total=panier.reduce((acc,p)=>acc+p.prix*(1+0.08),0); // frais 8%
const commande={
clientNom:clientNom.value,
clientTel:clientTel.value,
receveurNom:receveurNom.value,
receveurTel:receveurTel.value,
ville:villeLivraison.value,
produits:[...panier],
total:Math.round(total)
};
commandes.push(commande);
localStorage.setItem("commandes",JSON.stringify(commandes));
alert("Commande envoyÃ©e !");

panier=[];
localStorage.removeItem("panier");
afficherPanier();
};

/* ADMIN */
function afficherCommandes(){
const c=document.getElementById("admin-commandes");
c.innerHTML="";
commandes.forEach((cmd,i)=>{
c.innerHTML+=`<div style="background:#004400;padding:10px;margin-bottom:10px">
<h4>Commande #${i+1}</h4>
<p>Client: ${cmd.clientNom} (${cmd.clientTel})</p>
<p>Receveur: ${cmd.receveurNom} (${cmd.receveurTel})</p>
<p>Ville: ${cmd.ville}</p>
<p>Total: ${cmd.total} FG</p>
<ul>${cmd.produits.map(p=>`<li>${p.nom} - ${p.prix} FG (x${p.quantite}) Vendeur: ${p.vendeur}</li>`).join("")}</ul>
</div>`;
});
}

afficherProduits();
afficherPanier();
</script>
</body>
  </html>
